/*
1. Select all the information from the customer table.

Whoever wants to buy anything in our store needs to register as a customer. Each customer in our system has an id, first_name and last_name, join_date and the country.
*/

SELECT id, first_name, last_name, join_date, country
FROM customer;


/*
2. Select all the information from the movie table.

Movies in our system have their ids and titles, of course. Then, there is the year of release, the genre of the movie and the rating by the editors of the store (0-10).
*/

SELECT id, title, release_year, genre, editor_rating
FROM movie


/*
3. Select all the information from the review table.

Customers can rate movies, too! This is done via reviews. Each review has an id, a rating (0-10), the customer_id and the movie_id, of course.
*/

SELECT id, rating, customer_id, movie_id
FROM review 


/*
4. Select all the information from the single_rental table.

Now, let's get down to business. The first possibility in our store is to rent a single movie for a certain period of time. Each rental has an id, rental_date (when the rent starts), rental_period (in days), the platform (desktop, mobile or tablet), customer_id, movie_id, payment_date (you can pay a few day after you rent) and the payment_amount, or the price.
*/

SELECT id, rental_date, rental_period, platform, customer_id, movie_id, payment_date, payment_amount
FROM single_rental;


/*
5. Select all the information from the subscription table.

Real movie lovers get a subscription instead of single rentals. Each subscription has an id, a length (in days), a start_date, a platform (same as the platforms for single rentals), payment_date, payment_amount and customer_id.
*/

SELECT id, length, start_date, platform, payment_date, payment_amount, customer_id
FROM subscription;


/*
6. Select all the information from the giftcard table.

The last thing you can purchase are giftcards for someone else. Each giftcard has an id, amount_worth (30, 50 or 100 dollars to spend in our store), customer_id, payment_date and payment_amount.
*/

SELECT id, amount_worth, customer_id, payment_date, payment_amount
FROM giftcard;



/*
7. Show each gift card purchased: id, amount_worth and the total number of all gift cards purchased.
*/

SELECT
  id,
  amount_worth,
  COUNT(id) OVER()
FROM giftcard;


/*
8. Show each subscription: id, length, start_date, payment_amount and the total amount paid for all subscriptions ever.
*/

SELECT
  id,
  length,
  start_date,
  payment_amount,
  SUM(payment_amount) OVER()
FROM subscription;



/*
9. Show each single rental: id, rental_period, payment_amount, the average amount paid from all the single rentals ever and the ratio of the two last columns.
*/

SELECT
  id,
  rental_period, 
  payment_amount,
  AVG(payment_amount) OVER(),
  payment_amount / AVG(payment_amount) OVER()
FROM single_rental;



/*
10. For each movie, show its title, editor_rating, genre and the average editor_rating of all movies of the same genre.
*/

SELECT
  title, 
  editor_rating, 
  genre,
  AVG(editor_rating) OVER(PARTITION BY genre)
FROM movie;



/*
11. 
*/



/*
12. 
*/



/*
13. 
*/



/*
14. 
*/



/*
15. 
*/



/*
16. 
*/



/*
17. 
*/



/*
18. 
*/



/*
19. 
*/



/*
20. 
*/



/*
21. 
*/



/*
22. 
*/



/*
23. 
*/



/*
24. 
*/



/*
25. 
*/



