/*
1. Select all the information from the website table.

Each website has an id, name, monthly budget and the date of opening (opened).
*/

SELECT id,	name,	budget,	opened
FROM website


/*
2. Select all the information from the statistics table.

In this table, you can find the statistics from May 2016. Each generated statistics row corresponds to a certain website_id and a particular day. Column users shows how many unique people visited the website that day. Column impressions indicates how many times an advertisement was shown to a user. clicks means the number of clicks on an advertisement. Column revenue is the total profit generated by those clicks on that day.
*/

SELECT website_id,	day,	users,	impressions,	clicks,	revenue
FROM statistics 

-- ////////////

SELECT
  name,
  opened,
  LEAD(name) OVER(ORDER BY opened)
FROM website;

-- /////////////////

SELECT
  name,
  opened,
  budget,
  LEAD(budget) OVER(ORDER BY opened)
FROM website;

/*
3. For all the statistics of the website with id = 1, show the day, the number of users and the number of users on the next day.
*/

SELECT day, users, LEAD(users) OVER(ORDER BY day)
FROM statistics 
WHERE website_id = 1

-- ////////////

SELECT
  day,
  clicks,
  LEAD(clicks) OVER(ORDER BY day),
  LEAD(clicks) OVER(ORDER BY day) - clicks AS difference
FROM statistics
WHERE website_id = 2;


/*
4. For website_id = 1, show each statistics row: day, revenue, revenue on the next day and the difference between these two values (as next day's minus that day's revenue).
*/

SELECT day, revenue, LEAD(revenue) OVER(ORDER BY day), LEAD(revenue) OVER(ORDER BY day) - revenue AS difference
FROM statistics 
WHERE website_id = 1


/*
5.
*/


/*
6.
*/


/*
7.
*/


/*
8.
*/


/*
9.
*/


/*
10.
*/


/*
11.
*/


/*
12.
*/


/*
13.
*/


/*
14.
*/


/*
15.
*/


/*
16.
*/


/*
17.
*/


/*
18.
*/


/*
19.
*/